<Activity mc:Ignorable="sap sap2010" x:Class="Main" mva:VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="1248.8,3791.2" sap2010:WorkflowViewState.IdRef="Main_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:njl="clr-namespace:Newtonsoft.Json.Linq;assembly=Newtonsoft.Json" xmlns:p="http://schemas.uipath.com/workflow/activities/azureactivedirectory" xmlns:r="clr-namespace:RestSharp;assembly=RestSharp" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:ss="clr-namespace:System.Security;assembly=mscorlib" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:uja="clr-namespace:UiPath.JiraSoftware.Activities;assembly=UiPath.JiraSoftware.Activities" xmlns:ujac="clr-namespace:UiPath.JiraSoftware.Activities.Comments;assembly=UiPath.JiraSoftware.Activities" xmlns:ujai="clr-namespace:UiPath.JiraSoftware.Activities.Issues;assembly=UiPath.JiraSoftware.Activities" xmlns:ujat="clr-namespace:UiPath.JiraSoftware.Activities.Transitions;assembly=UiPath.JiraSoftware.Activities" xmlns:ujm="clr-namespace:UiPath.JiraSoftware.Models;assembly=UiPath.JiraSoftware" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="30">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Net</x:String>
      <x:String>UiPath.AzureActiveDirectory.Contracts.Users</x:String>
      <x:String>UiPath.AzureActiveDirectory.Contracts</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>UiPath.AzureActiveDirectory.Contracts.Groups</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.JiraSoftware.Models</x:String>
      <x:String>Newtonsoft.Json.Linq</x:String>
      <x:String>Newtonsoft.Json</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="22">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.AzureActiveDirectory</AssemblyReference>
      <AssemblyReference>UiPath.JiraSoftware</AssemblyReference>
      <AssemblyReference>Newtonsoft.Json</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="ITSM AD UserOperations PasswordReset Sequence " sap:VirtualizedContainerService.HintSize="1156,3726.4" sap2010:WorkflowViewState.IdRef="Sequence_3">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:Boolean" Name="getAssetsFromOrchestrator" />
      <Variable x:TypeArguments="x:String" Name="azureADTenantId" />
      <Variable x:TypeArguments="x:String" Name="azureADClientId" />
      <Variable x:TypeArguments="x:Boolean" Name="userExist" />
      <Variable x:TypeArguments="ss:SecureString" Name="azureADPassword" />
      <Variable x:TypeArguments="x:String" Name="azureADUsername" />
      <Variable x:TypeArguments="x:String" Name="azureADUserUpn" />
      <Variable x:TypeArguments="x:Boolean" Default="True" Name="forcePasswordChange" />
      <Variable x:TypeArguments="x:String" Name="azureADNewPassword" />
      <Variable x:TypeArguments="x:String" Name="in_JiraUserName">
        <Variable.Default>
          <Literal x:TypeArguments="x:String" Value="" />
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="x:String" Name="in_JiraAPIToken">
        <Variable.Default>
          <Literal x:TypeArguments="x:String" Value="" />
        </Variable.Default>
      </Variable>
      <Variable x:TypeArguments="x:String" Name="in_JiraServerURL">
        <Variable.Default>
          <Literal x:TypeArguments="x:String" Value="" />
        </Variable.Default>
      </Variable>
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <uja:JiraSoftwareApplicationScope RestClient="{x:Null}" DisplayName="Jira Software Application Scope" sap:VirtualizedContainerService.HintSize="1114.4,3633.6" sap2010:WorkflowViewState.IdRef="JiraSoftwareApplicationScope_1" JiraToken="[in_JiraAPIToken]" JiraURL="[in_JiraServerURL]" JiraUsername="[in_JiraUserName]">
      <uja:JiraSoftwareApplicationScope.Body>
        <ActivityAction x:TypeArguments="r:RestClient">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="r:RestClient" Name="RestClient" />
          </ActivityAction.Argument>
          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="1080.8,3547.2" sap2010:WorkflowViewState.IdRef="Sequence_13">
            <Sequence.Variables>
              <Variable x:TypeArguments="ujm:Issue[]" Name="jiraIssues" />
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ujai:SearchIssuesUsingJQL MaxResults="{x:Null}" StartAt="{x:Null}" TotalNumberOfIssues="{x:Null}" DisplayName="Search issues using JQL" sap:VirtualizedContainerService.HintSize="1039.2,22.4" sap2010:WorkflowViewState.IdRef="SearchIssuesUsingJQL_1" JQL="[&quot;project = &quot;&quot;IT Automation&quot;&quot; AND assignee = currentuser()&quot;]" Result="[jiraIssues]" />
            <ui:ForEach x:TypeArguments="ujm:Issue" CurrentIndex="{x:Null}" DisplayName="For Each Issue" sap:VirtualizedContainerService.HintSize="1039.2,3392" sap2010:WorkflowViewState.IdRef="ForEach`1_1" Values="[jiraIssues]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="ujm:Issue">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="ujm:Issue" Name="issue" />
                  </ActivityAction.Argument>
                  <Sequence sap:VirtualizedContainerService.HintSize="1004,3257.6" sap2010:WorkflowViewState.IdRef="Sequence_17">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If Condition="[issue.Fields.Summary.Contains(&quot;UserPasswordReset&quot;) And issue.Fields.Status.Name.Equals(&quot;To Do&quot;)]" sap:VirtualizedContainerService.HintSize="962.4,3164.8" sap2010:WorkflowViewState.IdRef="If_4">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <If.Then>
                        <Sequence sap:VirtualizedContainerService.HintSize="818.4,3015.2" sap2010:WorkflowViewState.IdRef="Sequence_15">
                          <Sequence.Variables>
                            <Variable x:TypeArguments="scg:Dictionary(x:String, x:Object)" Name="issueAllFieldsDictionary" />
                            <Variable x:TypeArguments="ujm:Transition[]" Name="issueTrasitions" />
                          </Sequence.Variables>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="776.8,92.8" sap2010:WorkflowViewState.IdRef="LogMessage_12" Level="Info" Message="[issue.Fields.Summary + &quot; &quot; + issue.Fields.Status.Name]" />
                          <ujai:GetIssue Result="{x:Null}" AllFieldsDictionary="[issueAllFieldsDictionary]" DisplayName="Get Issue" EntityId="[issue.Id]" sap:VirtualizedContainerService.HintSize="777,59" sap2010:WorkflowViewState.IdRef="GetIssue_1" />
                          <ui:ForEach x:TypeArguments="scg:KeyValuePair(x:String, x:Object)" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="777,276" sap2010:WorkflowViewState.IdRef="ForEach`1_6" Values="[issueAllFieldsDictionary]">
                            <ui:ForEach.Body>
                              <ActivityAction x:TypeArguments="scg:KeyValuePair(x:String, x:Object)">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="scg:KeyValuePair(x:String, x:Object)" Name="item" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_16">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If Condition="[item.Key.Equals(&quot;description&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_5">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_19">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="njl:JObject" Name="issueDescriptionJSON" />
                                          <Variable x:TypeArguments="s:String[]" Name="issueDescriptionInfos" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:DeserializeJson x:TypeArguments="njl:JObject" DisplayName="Deserialize JSON" sap:VirtualizedContainerService.HintSize="338,59" sap2010:WorkflowViewState.IdRef="DeserializeJson`1_4" JsonObject="[issueDescriptionJSON]" JsonString="[item.Value.ToString]" />
                                        <Assign sap:VirtualizedContainerService.HintSize="338,60" sap2010:WorkflowViewState.IdRef="Assign_9">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="s:String[]">[issueDescriptionInfos]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="s:String[]">[issueDescriptionJSON.SelectToken("content")(0).SelectToken("content")(0).SelectToken("text").ToString.Split(" "C)]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <ui:MultipleAssign DisplayName="Multiple Assign" sap:VirtualizedContainerService.HintSize="338,160" sap2010:WorkflowViewState.IdRef="MultipleAssign_3">
                                          <ui:MultipleAssign.AssignOperations>
                                            <scg:List x:TypeArguments="ui:AssignOperation" Capacity="4">
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_8">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="x:String">[azureADUserUpn]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="x:String">[issueDescriptionInfos(2)]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_9">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="x:Boolean">[forcePasswordChange]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="x:Boolean">[Boolean.Parse(issueDescriptionInfos(0))]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                              <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_10">
                                                <ui:AssignOperation.To>
                                                  <OutArgument x:TypeArguments="x:String">[azureADNewPassword]</OutArgument>
                                                </ui:AssignOperation.To>
                                                <ui:AssignOperation.Value>
                                                  <InArgument x:TypeArguments="x:String">[issueDescriptionInfos(1)]</InArgument>
                                                </ui:AssignOperation.Value>
                                              </ui:AssignOperation>
                                            </scg:List>
                                          </ui:MultipleAssign.AssignOperations>
                                        </ui:MultipleAssign>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="338,91" sap2010:WorkflowViewState.IdRef="LogMessage_20" Message="[&quot;UserId: &quot; +azureADUserUpn + vbNewLine + &quot;Password: &quot; + azureADNewPassword + vbNewLine + &quot;Force pasword change: &quot; + forcePasswordChange.ToString]" />
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                </Sequence>
                              </ActivityAction>
                            </ui:ForEach.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ForEach>
                          <Assign sap2010:Annotation.AnnotationText="When the variable getAssetsFromOrchestrator has the value true, we will take the credentials for the active directory from the orchestrator assets, when it is false you have to enter them manually (else branch of the next if). &#xA;Please change the value of the variable according to your needs." sap:VirtualizedContainerService.HintSize="777,207" sap2010:WorkflowViewState.IdRef="Assign_1">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Boolean">[getAssetsFromOrchestrator]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                            </Assign.Value>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </Assign>
                          <If Condition="[getAssetsFromOrchestrator]" DisplayName="If you want to get your information from orchestrator assets" sap:VirtualizedContainerService.HintSize="777,51" sap2010:WorkflowViewState.IdRef="If_3">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <If.Then>
                              <TryCatch DisplayName="Try Get Assets from Orchestrator " sap:VirtualizedContainerService.HintSize="438,596" sap2010:WorkflowViewState.IdRef="TryCatch_3">
                                <TryCatch.Try>
                                  <Sequence DisplayName="Get Assets from Orchestrator Sequence" sap:VirtualizedContainerService.HintSize="376,369" sap2010:WorkflowViewState.IdRef="Sequence_10">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_9" Level="Info" Message="[&quot;We use data from the orchestrator to connect to AzureAD&quot;]" />
                                    <ui:GetRobotCredential TimeoutMS="{x:Null}" AssetName="ITA_AzureAD_ClientCredentials" DisplayName="Get Azure AccountCredentials" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="GetRobotCredential_2" Password="[azureADPassword]" Username="[azureADUsername]" />
                                    <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="ITA_AzureAD_TenantId" DisplayName="Get Asset Azure TenantID" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="GetRobotAsset_2">
                                      <ui:GetRobotAsset.Value>
                                        <OutArgument x:TypeArguments="x:String">[azureADTenantId]</OutArgument>
                                      </ui:GetRobotAsset.Value>
                                    </ui:GetRobotAsset>
                                    <ui:GetRobotAsset TimeoutMS="{x:Null}" AssetName="ITA_AzureAD_TenantId" DisplayName="Get Asset Azure ClientID" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="GetRobotAsset_3">
                                      <ui:GetRobotAsset.Value>
                                        <OutArgument x:TypeArguments="x:String">[azureADClientId]</OutArgument>
                                      </ui:GetRobotAsset.Value>
                                    </ui:GetRobotAsset>
                                  </Sequence>
                                </TryCatch.Try>
                                <TryCatch.Catches>
                                  <Catch x:TypeArguments="ui:OrchestratorHttpException" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_3">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ActivityAction x:TypeArguments="ui:OrchestratorHttpException">
                                      <ActivityAction.Argument>
                                        <DelegateInArgument x:TypeArguments="ui:OrchestratorHttpException" Name="exception" />
                                      </ActivityAction.Argument>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_10" Level="Error" Message="[&quot;An exception occurred when trying to get assets from the orchestrator.&quot;  + vbNewLine  + &quot;Exception: &quot; + exception.ToString]" />
                                    </ActivityAction>
                                  </Catch>
                                </TryCatch.Catches>
                              </TryCatch>
                            </If.Then>
                            <If.Else>
                              <Sequence DisplayName="Manual completion of values Sequence" sap:VirtualizedContainerService.HintSize="380,556" sap2010:WorkflowViewState.IdRef="Sequence_11">
                                <Sequence.Variables>
                                  <Variable x:TypeArguments="ui:GenericValue" Name="azureADStringPassword" />
                                </Sequence.Variables>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="338,91" sap2010:WorkflowViewState.IdRef="LogMessage_11" Level="Info" Message="[&quot;We use manually entered data to connect to AzureAD&quot;]" />
                                <ui:MultipleAssign sap2010:Annotation.AnnotationText="Add values to the right of the assignment operations with the values you use to connect to AzureAD" DisplayName="MultipleAssign for  AzureAD connection credentials" sap:VirtualizedContainerService.HintSize="338,233" sap2010:WorkflowViewState.IdRef="MultipleAssign_2">
                                  <ui:MultipleAssign.AssignOperations>
                                    <scg:List x:TypeArguments="ui:AssignOperation" Capacity="8">
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_4">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[azureADTenantId]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">
                                            <Literal x:TypeArguments="x:String" Value="" />
                                          </InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_5">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[azureADClientId]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">
                                            <Literal x:TypeArguments="x:String" Value="" />
                                          </InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_6">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="ui:GenericValue">[azureADStringPassword]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="ui:GenericValue">[""]</InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                      <ui:AssignOperation sap2010:WorkflowViewState.IdRef="AssignOperation_7">
                                        <ui:AssignOperation.To>
                                          <OutArgument x:TypeArguments="x:String">[azureADUsername]</OutArgument>
                                        </ui:AssignOperation.To>
                                        <ui:AssignOperation.Value>
                                          <InArgument x:TypeArguments="x:String">
                                            <Literal x:TypeArguments="x:String" Value="" />
                                          </InArgument>
                                        </ui:AssignOperation.Value>
                                      </ui:AssignOperation>
                                    </scg:List>
                                  </ui:MultipleAssign.AssignOperations>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                </ui:MultipleAssign>
                                <Assign DisplayName="Assign. Create a secure string from your Client Secret string" sap:VirtualizedContainerService.HintSize="338,60" sap2010:WorkflowViewState.IdRef="Assign_6">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="ss:SecureString">[azureADPassword]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="ss:SecureString">[(new System.Net.NetworkCredential("",azureADStringPassword)).SecurePassword]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </Sequence>
                            </If.Else>
                          </If>
                          <ui:LogMessage DisplayName="Log ClientID &amp; TenantID" sap:VirtualizedContainerService.HintSize="777,91" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[&quot;Azure Client ID: &quot; + azureADClientId +vbNewLine + &quot;Azure Tenant ID:&quot; + azureADTenantId]">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:LogMessage>
                          <TryCatch DisplayName="Try update user" sap:VirtualizedContainerService.HintSize="777,1123" sap2010:WorkflowViewState.IdRef="TryCatch_2">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <TryCatch.Try>
                              <p:AzureADDelegatedScope ClientId="[azureADClientId]" DisplayName="Azure AD Delegated Scope" sap:VirtualizedContainerService.HintSize="739,896" sap2010:WorkflowViewState.IdRef="AzureADDelegatedScope_1" Password="[azureADPassword]" TenantId="[azureADTenantId]" Username="[azureADUsername]">
                                <p:AzureADDelegatedScope.Body>
                                  <ActivityAction x:TypeArguments="p:AzureADConnector">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="p:AzureADConnector" Name="AzureScopePropertyTag" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="705,810" sap2010:WorkflowViewState.IdRef="Sequence_2">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:Comment sap:VirtualizedContainerService.HintSize="663,93" sap2010:WorkflowViewState.IdRef="Comment_1" Text="To update user we use the value received as argument. If the workflow does not receive this argument, override the default values." />
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="663,91" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Info" Message="[&quot;Checking if user exists..&quot;]" />
                                      <p:AzureADUserExists DisplayName="User Exists" Exists="[userExist]" sap:VirtualizedContainerService.HintSize="663,22" sap2010:WorkflowViewState.IdRef="AzureADUserExists_1" UserIdOrUpn="[azureADUserUpn]" />
                                      <If Condition="[userExist]" sap:VirtualizedContainerService.HintSize="663,392" sap2010:WorkflowViewState.IdRef="If_2">
                                        <If.Then>
                                          <Sequence sap:VirtualizedContainerService.HintSize="242,114" sap2010:WorkflowViewState.IdRef="Sequence_12">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <p:AzureADResetPassword DisplayName="Reset Password" ForcePasswordChangeNextLogin="[forcePasswordChange]" ForcePasswordChangeNextLoginMfa="False" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AzureADResetPassword_1" Password="[azureADNewPassword]" UserIdOrUpn="[azureADUserUpn]" />
                                          </Sequence>
                                        </If.Then>
                                        <If.Else>
                                          <Sequence sap:VirtualizedContainerService.HintSize="376,245" sap2010:WorkflowViewState.IdRef="Sequence_8">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_7" Level="Info" Message="[&quot;User &quot; + azureADUserUpn + &quot; does not exist.&quot;]" />
                                            <TerminateWorkflow DisplayName="Terminate Workflow" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="TerminateWorkflow_1" Reason="[&quot;User &quot; + azureADUserUpn + &quot; does not exist.&quot;]" />
                                          </Sequence>
                                        </If.Else>
                                      </If>
                                    </Sequence>
                                  </ActivityAction>
                                </p:AzureADDelegatedScope.Body>
                              </p:AzureADDelegatedScope>
                            </TryCatch.Try>
                            <TryCatch.Catches>
                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="743,21" sap2010:WorkflowViewState.IdRef="Catch`1_2">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ActivityAction x:TypeArguments="s:Exception">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                  </ActivityAction.Argument>
                                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_5" Level="Error" Message="[&quot;An exception occurred when trying to change status for user &quot; + azureADUserUpn + vbNewLine  + &quot;Exception: &quot; + exception.ToString]" />
                                </ActivityAction>
                              </Catch>
                            </TryCatch.Catches>
                          </TryCatch>
                          <ujat:GetTransitions DisplayName="Get Transitions" sap:VirtualizedContainerService.HintSize="777,22" sap2010:WorkflowViewState.IdRef="GetTransitions_1" IssueId="[issue.Id]" Result="[issueTrasitions]" />
                          <ui:ForEach x:TypeArguments="ujm:Transition" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="777,679" sap2010:WorkflowViewState.IdRef="ForEach`1_7" Values="[issueTrasitions]">
                            <ui:ForEach.Body>
                              <ActivityAction x:TypeArguments="ujm:Transition">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="ujm:Transition" Name="transition" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="563,546" sap2010:WorkflowViewState.IdRef="Sequence_22">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="x:String" Name="returnCode" />
                                    <Variable x:TypeArguments="scg:List(ujm:Comment)" Name="rez" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If Condition="[transition.Name.Equals(&quot;Closed&quot;)]" sap:VirtualizedContainerService.HintSize="521,454" sap2010:WorkflowViewState.IdRef="If_6">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence sap:VirtualizedContainerService.HintSize="376,307" sap2010:WorkflowViewState.IdRef="Sequence_21">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="ujm:Comment" Name="addedComment" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_22" Level="Info" Message="[issue.key + &quot;  &quot; +transition.Id]" />
                                        <ujac:AddCommentToIssue CommentText="This is a commnet" DisplayName="Add Comment to Issue" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="AddCommentToIssue_1" IssueId="[issue.Id]" Result="[addedComment]">
                                          <ujac:AddCommentToIssue.Parameters>
                                            <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                          </ujac:AddCommentToIssue.Parameters>
                                        </ujac:AddCommentToIssue>
                                        <ujai:ChangeIssueStatus DisplayName="Change Issue Status" sap:VirtualizedContainerService.HintSize="334,22" sap2010:WorkflowViewState.IdRef="ChangeIssueStatus_1" IssueId="[issue.id]" TransitionId="[transition.id]">
                                          <ujai:ChangeIssueStatus.Parameters>
                                            <scg:Dictionary x:TypeArguments="x:String, InArgument" />
                                          </ujai:ChangeIssueStatus.Parameters>
                                        </ujai:ChangeIssueStatus>
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                </Sequence>
                              </ActivityAction>
                            </ui:ForEach.Body>
                          </ui:ForEach>
                        </Sequence>
                      </If.Then>
                    </If>
                  </Sequence>
                </ActivityAction>
              </ui:ForEach.Body>
            </ui:ForEach>
          </Sequence>
        </ActivityAction>
      </uja:JiraSoftwareApplicationScope.Body>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
    </uja:JiraSoftwareApplicationScope>
  </Sequence>
</Activity>